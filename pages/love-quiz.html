<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love Language Game Show üíú</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Playfair+Display:wght@400;700&family=Bungee+Shade&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #1a0b2e;
            min-height: 100vh;
            overflow-x: hidden;
            color: white;
        }

        /* Spotlight Effect */
        .spotlight {
            position: fixed;
            top: -50%;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(167, 139, 250, 0.15) 0%, transparent 70%);
            pointer-events: none;
            z-index: 0;
        }

        /* Game Card */
        .game-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 40px rgba(139, 92, 246, 0.3);
            transform-style: preserve-3d;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .game-title {
            font-family: 'Bungee Shade', cursive;
            text-shadow: 0 0 20px rgba(236, 72, 153, 0.5);
        }

        /* Answer Buttons */
        .answer-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }
        .answer-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.02);
            box-shadow: 0 0 20px rgba(167, 139, 250, 0.4);
        }
        .answer-btn.correct {
            background: linear-gradient(90deg, #059669, #10b981);
            border-color: #34d399;
            box-shadow: 0 0 30px rgba(16, 185, 129, 0.6);
            animation: pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .answer-btn.wrong {
            background: linear-gradient(90deg, #dc2626, #ef4444);
            border-color: #f87171;
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        @keyframes shake {
            10%, 90% { transform: translate3d(-1px, 0, 0); }
            20%, 80% { transform: translate3d(2px, 0, 0); }
            30%, 50%, 70% { transform: translate3d(-4px, 0, 0); }
            40%, 60% { transform: translate3d(4px, 0, 0); }
        }

        /* Love Meter */
        .love-meter-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 999px;
            padding: 4px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .love-meter-fill {
            background: linear-gradient(90deg, #ec4899, #8b5cf6);
            border-radius: 999px;
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 20px rgba(236, 72, 153, 0.5);
            position: relative;
            overflow: hidden;
        }
        .love-meter-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transform: translateX(-100%);
            animation: shimmer 2s infinite;
        }

        /* Floating Emojis */
        .floater {
            position: absolute;
            pointer-events: none;
            animation: floatUp 8s linear infinite;
            opacity: 0;
        }
        @keyframes floatUp {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            100% { transform: translateY(-20vh) rotate(360deg); opacity: 0; }
        }
    </style>
</head>
<body class="flex flex-col items-center justify-center p-4">
    <div class="spotlight"></div>
    <div id="floaters-container"></div>

    <!-- Main Game Container -->
    <div class="relative z-10 w-full max-w-3xl">
        
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="game-title text-4xl md:text-6xl text-white mb-2">LOVE QUIZ</h1>
            <p class="text-purple-300 tracking-widest uppercase text-sm font-bold">How well do you know us?</p>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="game-card rounded-3xl p-10 text-center">
            <div class="text-8xl mb-6 animate-bounce">üéÆ</div>
            <h2 class="text-3xl font-bold text-white mb-4 font-serif">Ready Player One?</h2>
            <p class="text-gray-300 text-lg mb-8 leading-relaxed">
                I've prepared 11 special questions about our journey. 
                <br>Prove you're the ultimate expert on "Us"! üíú
            </p>
            <button onclick="startQuiz()" class="group relative px-8 py-4 bg-white text-purple-900 rounded-full text-xl font-bold hover:bg-purple-50 transition-all hover:scale-105 hover:shadow-[0_0_30px_rgba(255,255,255,0.5)]">
                <span class="relative z-10">Start The Game üöÄ</span>
            </button>
        </div>

        <!-- Quiz Screen -->
        <div id="quiz-screen" class="hidden">
            <!-- Stats Bar -->
            <div class="flex justify-between items-end mb-4 px-2">
                <div class="text-left">
                    <span class="text-xs text-purple-300 uppercase tracking-wider">Question</span>
                    <p class="text-2xl font-bold"><span id="current-question">1</span><span class="text-gray-500 text-lg">/11</span></p>
                </div>
                <div class="text-right">
                    <span class="text-xs text-purple-300 uppercase tracking-wider">Score</span>
                    <p class="text-2xl font-bold text-pink-400" id="current-score">0</p>
                </div>
            </div>

            <!-- Love Meter -->
            <div class="love-meter-container h-6 w-full mb-8">
                <div id="love-meter" class="love-meter-fill h-full" style="width: 0%"></div>
            </div>

            <!-- Question Card -->
            <div class="game-card rounded-3xl p-8 md:p-12 relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-purple-500 via-pink-500 to-purple-500"></div>
                
                <div class="text-center mb-10">
                    <div class="text-6xl mb-6 transform hover:scale-110 transition-transform cursor-default" id="question-emoji">‚ùì</div>
                    <h3 class="text-2xl md:text-3xl font-bold text-white leading-snug" id="question-text">Loading...</h3>
                </div>

                <div class="grid grid-cols-1 gap-4" id="answers-container">
                    <!-- Answers injected here -->
                </div>

                <div class="mt-8 text-center h-12">
                    <button id="next-btn" onclick="nextQuestion()" class="hidden px-8 py-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full font-bold hover:shadow-lg hover:scale-105 transition-all">
                        Next Question ‚Üí
                    </button>
                </div>
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="hidden game-card rounded-3xl p-10 text-center">
            <div class="text-8xl mb-6" id="result-emoji">üèÜ</div>
            <h2 class="text-4xl font-bold text-white mb-2" id="result-title">Perfect Score!</h2>
            <p class="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-400 mb-6 my-8">
                <span id="final-score">0</span>/11
            </p>
            <p class="text-xl text-gray-300 mb-10 font-serif italic" id="result-message">
                You know every beat of my heart.
            </p>
            
            <div class="flex flex-col md:flex-row gap-4 justify-center">
                <button onclick="restartQuiz()" class="px-8 py-3 bg-white/10 hover:bg-white/20 rounded-full font-bold transition-all border border-white/30">
                    Play Again üîÑ
                </button>
                <a href="../index.html" class="px-8 py-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full font-bold hover:shadow-lg hover:scale-105 transition-all text-white">
                    Back to Home üè†
                </a>
            </div>
        </div>

    </div>

    <script src="../js/config-loader.js"></script>
    <script src="../js/confetti.js"></script>
    <script src="../js/music.js"></script>
    <script src="../js/notes.js"></script>
    <script>
        // Quiz Data
        const quizData = [
            {
                emoji: "üí¨",
                question: "When did we first start talking?",
                answers: ["November 11, 2024", "December 25, 2024", "January 11, 2025", "February 14, 2025"],
                correct: 2
            },
            {
                emoji: "üíç",
                question: "What's the date we became official?",
                answers: ["September 7, 2025", "September 8, 2025", "September 9, 2025", "October 8, 2025"],
                correct: 1
            },
            {
                emoji: "üåô",
                question: "What do I call you when I talk about how you support me?",
                answers: ["My Queen", "My Oluwasetemi", "My Angel", "My Heart"],
                correct: 1
            },
            {
                emoji: "üî•",
                question: "What's my nickname that means you light my fire?",
                answers: ["Firelighter", "Spark", "Flame", "Blaze"],
                correct: 0
            },
            {
                emoji: "ü•∞",
                question: "What's my favorite nickname for you?",
                answers: ["Ayo", "Yomi", "Mide", "Setemi"],
                correct: 2
            },
            {
                emoji: "üíå",
                question: "How do I sign off in my letters to you?",
                answers: ["Your Love", "Forever Yours", "Your LumLum", "With Love"],
                correct: 2
            },
            {
                emoji: "üéµ",
                question: "What quality do I admire most about you?",
                answers: ["Your beauty", "Your faith and support", "Your intelligence", "Your receptive heart"],
                correct: 3
            },
            {
                emoji: "‚è∞",
                question: "Today marks how long since we became official?",
                answers: ["2 weeks", "3 weeks", "{{anniversaryDurationText}}", "6 weeks"],
                correct: 2
            },
            {
                emoji: "üåü",
                question: "What does 'Odunayo' mean?",
                answers: ["Gift of God", "Sweetness has arrived", "Joy of my life", "Beautiful one"],
                correct: 1
            },
            {
                emoji: "üìÖ",
                question: "How many promises did I make to you in the Promise Vault?",
                answers: ["20 promises", "30 promises", "40 promises", "50 promises"],
                correct: 2
            },
            {
                emoji: "üíù",
                question: "What's my favorite thing about our relationship?",
                answers: ["It's intentional", "It's easy", "It's perfect", "It's new"],
                correct: 0
            }
        ];

        let currentQuestion = 0;
        let score = 0;
        let answered = false;

        // Sound Effects (Simple Synth)
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playTone(freq, type, duration) {
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.type = type;
            osc.frequency.value = freq;
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            osc.start();
            gain.gain.exponentialRampToValueAtTime(0.00001, audioCtx.currentTime + duration);
            osc.stop(audioCtx.currentTime + duration);
        }

        function playCorrectSound() {
            playTone(600, 'sine', 0.1);
            setTimeout(() => playTone(800, 'sine', 0.2), 100);
        }

        function playWrongSound() {
            playTone(300, 'sawtooth', 0.2);
            setTimeout(() => playTone(200, 'sawtooth', 0.3), 150);
        }

        // Game Logic
        function startQuiz() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            answered = false;
            const q = quizData[currentQuestion];
            
            document.getElementById('question-emoji').textContent = q.emoji;
            document.getElementById('question-text').textContent = q.question;
            document.getElementById('current-question').textContent = currentQuestion + 1;
            document.getElementById('next-btn').classList.add('hidden');

            const container = document.getElementById('answers-container');
            container.innerHTML = '';

            q.answers.forEach((ans, idx) => {
                const btn = document.createElement('button');
                btn.className = 'answer-btn w-full p-5 rounded-xl text-left text-lg font-semibold text-white flex items-center group';
                btn.innerHTML = `
                    <span class="w-8 h-8 rounded-full border border-white/30 flex items-center justify-center mr-4 text-sm group-hover:bg-white group-hover:text-purple-900 transition-colors">${String.fromCharCode(65+idx)}</span>
                    ${ans}
                `;
                btn.onclick = () => checkAnswer(idx, btn);
                container.appendChild(btn);
            });
        }

        function checkAnswer(idx, btn) {
            if (answered) return;
            answered = true;

            const q = quizData[currentQuestion];
            const allBtns = document.querySelectorAll('.answer-btn');

            if (idx === q.correct) {
                btn.classList.add('correct');
                score++;
                playCorrectSound();
                // Trigger global confetti if available
                if (window.confetti) {
                    window.confetti({
                        particleCount: 50,
                        spread: 60,
                        origin: { y: 0.7 }
                    });
                }
            } else {
                btn.classList.add('wrong');
                allBtns[q.correct].classList.add('correct');
                playWrongSound();
            }

            // Update Score & Meter
            document.getElementById('current-score').textContent = score;
            const progress = (score / quizData.length) * 100; // Based on potential max score? No, based on current progress maybe? 
            // Actually let's make the meter fill up based on questions answered correctly vs total
            const meterFill = (score / quizData.length) * 100;
            document.getElementById('love-meter').style.width = `${meterFill}%`;

            document.getElementById('next-btn').classList.remove('hidden');
        }

        function nextQuestion() {
            currentQuestion++;
            if (currentQuestion < quizData.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        function showResults() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('results-screen').classList.remove('hidden');
            document.getElementById('final-score').textContent = score;

            let emoji, title, msg;
            if (score === 11) {
                emoji = "üëë"; title = "PERFECT!"; msg = "You are the Queen of my heart and this relationship!";
                if (window.confetti) {
                    const duration = 3000;
                    const end = Date.now() + duration;
                    (function frame() {
                        window.confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 } });
                        window.confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 } });
                        if (Date.now() < end) requestAnimationFrame(frame);
                    }());
                }
            } else if (score >= 8) {
                emoji = "üåü"; title = "Amazing!"; msg = "You know us so well. I love that about you.";
            } else {
                emoji = "üíú"; title = "Good Job!"; msg = "We have a lifetime to learn even more about each other.";
            }

            document.getElementById('result-emoji').textContent = emoji;
            document.getElementById('result-title').textContent = title;
            document.getElementById('result-message').textContent = msg;
        }

        function restartQuiz() {
            currentQuestion = 0;
            score = 0;
            document.getElementById('love-meter').style.width = '0%';
            document.getElementById('current-score').textContent = '0';
            document.getElementById('results-screen').classList.add('hidden');
            document.getElementById('start-screen').classList.remove('hidden');
        }

        // Background Floaters
        function createFloaters() {
            const container = document.getElementById('floaters-container');
            const emojis = ['üíú', '‚ú®', '‚ùì', 'üéÆ', 'üéµ'];
            
            setInterval(() => {
                const el = document.createElement('div');
                el.className = 'floater text-2xl';
                el.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                el.style.left = Math.random() * 100 + '%';
                el.style.animationDuration = (Math.random() * 5 + 5) + 's';
                container.appendChild(el);
                setTimeout(() => el.remove(), 10000);
            }, 1000);
        }

        document.addEventListener('DOMContentLoaded', async () => {
            createFloaters();
            
            // Dynamic Data Update
            if (window.SITE_CONFIG_READY) {
                const cfg = await window.SITE_CONFIG_READY;
                const durationText = cfg.anniversaryDurationText || 'Three months';
                
                quizData.forEach(q => {
                    q.answers = q.answers.map(a => a.replace('{{anniversaryDurationText}}', durationText));
                });
            }
        });
    </script>
</body>
</html>
